# **Three-Address Code (TAC) Generator**  

This project is the **third phase** of the **Compiler course** at **Khajeh Nasir University of Technology**, designed by **Professor Morteza Damanafshan**. It builds upon the **Lexical Analyzer (Phase 1)** and **Parser (Phase 2)** to generate **Three-Address Code (TAC)** for a given grammar \( G \).  

---

## **Project Overview**  

The main objective of this phase is to generate **intermediate code** (TAC) from an **Abstract Syntax Tree (AST)** produced by the parser for the grammar \( G \). This intermediate representation is crucial for further **code optimization** and **target machine code generation**.  

### Grammar \( G \)

The lexical analyzer supports the following grammar \( G \):

```plaintext
start â†’ program id ; decList funcList block

decList â†’ decs | decs decList
decs â†’ type varList ; | Ïµ
type â†’ integer | real | boolean
varList â†’ id | varList , id

funcList â†’ funcList funcDec | Ïµ
funcDec â†’ function id parameters : type decList block
parameters â†’ (decList)

block â†’ begin stmtList end
stmtList â†’ stmt | stmtList stmt
stmt â†’ id := expr ;
     | if expr then stmt
     | if expr then stmt else stmt
     | while expr do stmt
     | for id:=expr to expr do stmt
     | return expr ;
     | block

expr â†’ expr and expr | expr or expr
     | expr âˆ— expr | expr / expr
     | expr + expr | expr âˆ’ expr
     | expr relop expr
     | (expr)
     | integerNumber | realNumber
     | true | false
     | id(actualparamlist)
     | id

actualparamlist â†’ expr | actualparamlist, expr | id | Ïµ
relop â†’ < | <= | = | <> | >= | >
```

### **Key Features**  

âœ… **Lexical & Syntax Analysis**  

- Uses the `lexer.py` and `parser.py` to process the input program.  

âœ… **AST Construction**  

- The parser builds an **Abstract Syntax Tree (AST)** from the given program.  

âœ… **TAC Code Generation**  

- The `TACGenerator` converts AST into **TAC quadruples**.  
- Generates **labels** for control flow structures (loops, conditionals).  
- Supports **arithmetic, logical, relational, and assignment operations**.  

âœ… **File Handling**  

- Reads input from `input.txt` and writes the generated **TAC** to `output.txt`.  

---

## **System Requirements**  

- **Python 3.8 or higher**  
- **PLY (Python Lex-Yacc) Library**  

  ```bash
  pip install ply
  ```

---

## **Project Structure**  

```plaintext
ğŸ“‚ Phase3-Compiler
â”‚â”€â”€ input.txt                 # Source code to analyze (valid instance of grammar G)
â”‚â”€â”€ output.txt                # TAC output generated by the program
â”‚â”€â”€ codeGenerator.py          # TAC Generator implementation
â”‚â”€â”€ parser.py                 # Parser implementation (builds AST)
â”‚â”€â”€ lexer.py                  # Lexical Analyzer (from Phase 1)
â”‚â”€â”€ KNTU-Compiler-Project-Fall-1403.pdf  # Project details (provided by professor)
â”‚â”€â”€ main.py                   # Main execution script
```

---

## **Usage**  

### **1ï¸âƒ£ Prepare the Input File**  

- Write the source code inside `input.txt`.  
- Ensure the code follows the given **grammar \( G \)**.  

### **2ï¸âƒ£ Run the Program**  

```bash
python main.py
```

### **3ï¸âƒ£ Check the Output**  

- The **TAC code** will be generated in `output.txt`.  
- If **parsing fails**, an error message will be displayed.  

---

## **Output Format**  

The output (`output.txt`) consists of:  
1ï¸âƒ£ **Header**: Student name and ID  
2ï¸âƒ£ **Three-Address Code (TAC)**  

### **Example**  

**ğŸ“Œ Input (`input.txt`)**  

```plaintext
program prg1;
integer num, divisor, quotient;
begin
    num:=61;
    divisor:=2;
    quotient:=0;
    if num=1 then
        return false;
    else if num=2 then
        return true;
    while divisor<=(num/2) do
    begin
        quotient:=num/divisor;
        if divisor * quotient=num then
            return false;
        divisor:=divisor+1;
    end
    return true;
end
```

**ğŸ“Œ Output (`output.txt`)**  

```plaintext
Mohammad Taha Karbalaee Esmaeili - 40121803          Ù…Ø­Ù…Ø¯ Ø·Ø§Ù‡Ø§ Ú©Ø±Ø¨Ù„Ø§ÛŒ Ø§Ø³Ù…Ø¹ÛŒÙ„ÛŒ - Û´Û°Û±Û²Û±Û¸Û°Û³
t1 = 61
num = t1
t2 = 2
divisor = t2
t3 = 0
quotient = t3
t4 = 1
t5 = num = t4
if t5 goto L1
goto L2
L1:
t6 = False
return t6
goto L3
L2:
t7 = 2
t8 = num = t7
if t8 goto L4
goto L5
L4:
t9 = True
return t9
L5:
L3:
L6:
t10 = 2
t11 = num / t10
t12 = divisor <= t11
if t12 goto L7
goto L8
L7:
t13 = num / divisor
quotient = t13
t14 = divisor * quotient
t15 = t14 = num
if t15 goto L9
goto L10
L9:
t16 = False
return t16
L10:
t17 = 1
t18 = divisor + t17
divisor = t18
goto L6
L8:
t19 = True
return t19
```

---

## **How it Works**  

1ï¸âƒ£ **Lexical Analysis (`lexer.py`)**  

- Tokenizes the source code.  

2ï¸âƒ£ **Parsing (`parser.py`)**  

- Constructs an **AST** based on grammar rules.  

3ï¸âƒ£ **TAC Generation (`codeGenerator.py`)**  

- **Processes AST** and generates TAC quadruples.  
- **Handles expressions, loops, conditionals, and assignments.**  
- Uses **labels** for `if`, `while`, `for` statements.  

---

## **Main Components**  

### **ğŸ“ `main.py`**

- **Reads** input code (`input.txt`).  
- **Parses** the input and builds an AST.  
- **Generates** TAC using `TACGenerator`.  
- **Writes** TAC code to `output.txt`.  

### **âš™ï¸ `parser.py`**  

- Implements **grammar rules** and constructs an **AST**.  

### **ğŸ“Œ `codeGenerator.py`**  

- Converts **AST** into **TAC**.  
- Generates **temporary variables** and **labels**.  
- Produces **quadruple instructions**.  

---

## **Notes**  

- The project **strictly follows** the given **grammar \( G \)**.  
- The generated **TAC** is an **intermediate representation** (not executable machine code).  
- The `output.txt` will only contain TAC if parsing is successful.  

---

## **Author Information**  

- **Author**: Mohammad Taha Karbalaee Esmaeili  
- **Student ID**: 40121803  
- **Instructor**: Professor **Morteza Damanafshan**  
- **Course**: Compiler Design â€“ **Khajeh Nasir University of Technology**  

---

Now your **Phase 3** project is fully documented! ğŸš€
